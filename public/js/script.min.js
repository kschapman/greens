function getInfo(startingYear,endingYear,climateData,increment){$.ajax({url:"http://climatedataapi.worldbank.org/climateweb/rest/v1/country/annualavg/tas/"+startingYear+"/"+endingYear+"/NZL",dataType:"json",success:function(data){for(var currentAverage=0,total=0,i=0;i<data.length;i++)total+=data[i].annualData[0];currentAverage=total/data.length,isNaN(currentAverage)||(climateData.push({startingYear:startingYear,endingYear:endingYear,averageClimate:currentAverage}),climateData.length+1===finalSet&&climateData.length+1===finalSet&&runGraph(climateData=sortGraphValues(climateData)))},error:function(){console.log("Error, server not responding.")}})}function sortGraphValues(data){return data.sort(function(a,b){return a.startingYear-b.startingYear}),data}function runGraph(){for(var barColor,margin={top:30,right:30,bottom:30,left:30},graphHeight=$("#chart-container").height(),width=$("#chart-container").width()-margin.left-margin.right,height=graphHeight-margin.top-margin.bottom,averageClimate=[],period=[],i=0;i<climateData.length;i++)averageClimate.push(climateData[i].averageClimate),period.push(climateData[i].endingYear);var yScale=d3.scaleLinear().domain([0,d3.max(averageClimate)]).range([0,height]),xScale=d3.scaleBand().domain(d3.range(0,climateData.length)).range([0,width]),color=d3.scaleLinear().domain([0,averageClimate.length]).range(["#00DCE5","#E14532"]);d3.select("#chart-container").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).style("margin-top","10px").append("g").attr("transform","translate("+margin.left+", "+margin.top+")").attr("id","BarGraphShapes").selectAll("rect").data(averageClimate).enter().append("rect").style("fill",function(data,i){return color(i)}).attr("width",xScale.bandwidth()+"px").attr("height",0).attr("x",function(data,i){return xScale(i)}).attr("y",height).on("mouseover",function(data){mouseBar&&(barColor=this.style.fill,d3.select(this).style("opacity",.9))}).on("mouseout",function(data){d3.select(this).style("opacity",1)}).on("click",function(data){!0===mouseBar&&($("#change-heading").text("Rising Temperatures in Aotearoa"),$("#graph-values").text(data.toFixed(2)),$("#graph-values").fadeIn(1e3),$("#deg").fadeIn(1e3),$(".fa-bar-chart").hide())}).transition().duration(1e3).attr("height",function(data){return yScale(data)}).attr("y",function(data){return height-yScale(data)}).ease(d3.easeElasticOut).delay(function(data,i){return 300*i});var VGuideScale=d3.scaleLinear().domain([0,d3.max(averageClimate)]).range([height,0]),vAxis=d3.axisLeft(VGuideScale).ticks(Math.max.apply(Math,averageClimate)),vGuide=d3.select("svg").append("g");vAxis(vGuide),vGuide.attr("transform","translate("+margin.left+", "+margin.top+")"),vGuide.select("path").style("stroke","white");var hAxis=d3.axisBottom(xScale).tickArguments(xScale.domain([1939,1959,1979,1999,2039,2059,2079,2099])),hGuide=d3.select("svg").append("g");hAxis(hGuide),hGuide.attr("transform","translate("+margin.left+", "+(height+margin.top)+")"),hGuide.select("path").style("stroke","white");d3.selectAll("text").style("fill","white"),d3.selectAll("path").style("fill","white")}function initMap(){var welly={lat:-41.2912585,lng:174.77426},map=new google.maps.Map(document.getElementById("map"),{zoom:15,center:welly,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444 "}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#49524B "}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"simplified",color:"#49524B"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#72CA81"}]},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#9BE3F6"},{visibility:"on"}]}]});for(i=0;i<markers.length;i++){var position=new google.maps.LatLng(markers[i][1],markers[i][2]);marker=new google.maps.Marker({position:position,map:map,title:markers[i][0],icon:"img/MarkerGreen.png",markerID:markers[i][3]}),MarkerClickEvent(marker)}var boundsListener=google.maps.event.addListener(map,"bounds_changed",function(event){this.setZoom(14),google.maps.event.removeListener(boundsListener)})}function MarkerClickEvent(marker){google.maps.event.addListener(marker,"click",function(){$(".office").removeClass("office-click"),$("#"+marker.markerID).addClass("office-click")})}for(var startingYear=1920,endingYear=1939,finalSet=9,setPresentation=!1,mouseBar=!0,climateData=[],i=0;i<finalSet;i++)getInfo(startingYear,endingYear,climateData,i),startingYear+=20,endingYear+=20;$(".scrolling-padding").css("padding-top",$("#nav").height()),$("#about").css("height",$("#about").height()+$(".james-text").height()-$("#about").height()+$("#nav").height()+75),$(".present").click(function(){if($("#hidden-slider").slideDown(500),setPresentation)$(".fade-this").delay(1e3).fadeIn(1e3),$("#presentation").removeClass("fa-lock"),$("#presentation").addClass("fa-television"),$("#action-container").css("top",$("#graph-values").height()+5),$("#change-heading").text("Rising Temperatures in Aotearoa"),setPresentation=!1,mouseBar=!0;else{$("#action-container").height();var actionMarginTop=$("#value-container").height()+2;$(".fade-this").delay(1e3).fadeOut(1e3),$("#presentation").removeClass("fa-television"),$("#presentation").addClass("fa-lock"),$("#change-heading").text("Rising Temperatures in Aotearoa"),$("#value-container").css("height","auto"),$("#action-container").css("top",actionMarginTop),setPresentation=!0,mouseBar=!1}$("#hidden-slider").delay(2e3).slideUp(500)}),$("#presentation").hover(function(){mouseBar||($(this).removeClass("fa-lock"),$(this).addClass("fa-unlock-alt"))},function(){mouseBar||($(this).removeClass("fa-unlock-alt"),$(this).addClass("fa-lock"))}),$(document).on("click",'a[href^="#"]',function(e){var id=$(this).attr("href"),$id=$(id);if(0!==$id.length){e.preventDefault();var pos=$id.offset().top-$("#nav").height();$("body, html").animate({scrollTop:pos})}}),$.ajax({url:"http://localhost:3000/tweets.json",dataType:"json",success:function(data){for(var i=0;i<data.length;i++){var tweet=data[i];$("#twitter-feed").append("<p class='tweet-font'>"+tweet.text+"</p></br>")}},error:function(){console.log("somthing wrong")}});for(var markers=[["Bowen House",-41.2795458,174.7766301,"marker1","parliment","PARLIMENTARY OFFICE","Bowen House,<br> Lambton Quay,<br> Wellington,<br> 04-801 5102,<br>Fax: 04-472 6003"],["Green Party of Aotearoa New Zealand",-41.2935528,174.7722302,"marker2","garrett","GREEN PARTY OF AOTEAROA","Level 2<br>17 Garrett St<br> Te Aro,<br> Wellington,<br> 04-801 5102"]],popupBox,i=0;i<markers.length;i++)$("#offices").append("<div class='office' id='"+markers[i][3]+"'><div class='title'>"+markers[i][5]+"</div><div class='info'>"+markers[i][6]+"</div></div>");